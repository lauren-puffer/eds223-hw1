---
title: "Homework 1 - EDS 223"
author: "Lauren Puffer"
format: html
editor: visual
embed-resources: true
code-fold: show
execute: 
  warning: false
  message: false
toc: TRUE
theme: journal
---

## Introduction

The basis of this analysis is to better understand...

## Load Packages

For this analysis, we will be using the 'tmap' package to generate maps with data pulled from the 'Environmental Justice Screening and Mapping Tool.' We will also be using 'here' and 'tidyverse' for file management and workflow optimization.

```{r}
library(tmap)
library(here)
library(tidyverse)
library(sf) # allows us to bring in shape files for mapping
library(stars) # for raster and vector data
library(tigris) # for bringing in map of Arizona and counties
library(viridisLite) # colorblind friendly palettes
```

## Bring in EJ Screen data

```{r}
# make sure you are downloading shape files from 'tigris'
options(tigris_class = "sf")

# bring in shape files of US states
us_states <- states(class = "sf")

# get the geopackage of Arizona
az_shape <- us_states[us_states$STUSPS == "AZ", ]

# bring in shape file of Arizona counties 
az_counties <- counties(state = "AZ")

# bring in census tracts for Arizona
az_tracts <- tracts(state = "AZ")

# bring in just Maricopa county
maricopa_shape <- az_counties |>
  filter(NAME == "Maricopa")

# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 

# filter for data from Arizona
arizona <- ejscreen |>
  filter(ST_ABBREV == "AZ") 

# get data from Maricopa county
maricopa <- arizona |>
  filter(CNTY_NAME %in% c("Maricopa County"))

```

## Make maps

In order to explore the relationship between

```{r}
    # Plot Arizona
    tm_shape(az_shape) +
      tm_polygons(col = "lightblue", border.col = "black") + # Optional: set color and border
    tm_shape(az_tracts)+
      tm_borders()+
    tm_shape(az_counties)+
      tm_borders(col = "red")+
      tm_layout(title = "Map of Arizona")
    
# make a map of % in poverty in Maricopa county
    tm_shape(maricopa_shape) +
      tm_polygons()+
    tm_shape(maricopa)+
      tm_polygons(fill = "B_DEMOGIDX_2",
                  lwd = 0.5,
                  fill.scale = tm_scale(values = "viridis"),
                  title = "Low Income (%)")+
      tm_title("Maricopa County")
    
# make a map of cancer from toxic air pollutants in Maricopa county
    tm_shape(maricopa_shape) +
      tm_polygons()+
    tm_shape(maricopa)+
      tm_polygons(fill = "P_PTRAF",
                  lwd = 0.5,
                  fill.scale = tm_scale(values = "viridis"),
                  title = "Cancer from Toxic Air Pollutants")+
      tm_title("Maricopa County")

```
